{"ast":null,"code":"'use strict';\n\nvar _classCallCheck = require(\"/Users/S/Desktop/nodeprotake2/crowdburst/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/Users/S/Desktop/nodeprotake2/crowdburst/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _get = require(\"/Users/S/Desktop/nodeprotake2/crowdburst/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/get\");\n\nvar _getPrototypeOf = require(\"/Users/S/Desktop/nodeprotake2/crowdburst/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/getPrototypeOf\");\n\nvar _inherits = require(\"/Users/S/Desktop/nodeprotake2/crowdburst/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/inherits\");\n\nvar _createSuper = require(\"/Users/S/Desktop/nodeprotake2/crowdburst/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/createSuper\");\n\nvar AggregateOperation = require('./aggregate');\n\nvar CountDocumentsOperation = /*#__PURE__*/function (_AggregateOperation) {\n  _inherits(CountDocumentsOperation, _AggregateOperation);\n\n  var _super = _createSuper(CountDocumentsOperation);\n\n  function CountDocumentsOperation(collection, query, options) {\n    _classCallCheck(this, CountDocumentsOperation);\n\n    var pipeline = [{\n      $match: query\n    }];\n\n    if (typeof options.skip === 'number') {\n      pipeline.push({\n        $skip: options.skip\n      });\n    }\n\n    if (typeof options.limit === 'number') {\n      pipeline.push({\n        $limit: options.limit\n      });\n    }\n\n    pipeline.push({\n      $group: {\n        _id: 1,\n        n: {\n          $sum: 1\n        }\n      }\n    });\n    return _super.call(this, collection, pipeline, options);\n  }\n\n  _createClass(CountDocumentsOperation, [{\n    key: \"execute\",\n    value: function execute(server, callback) {\n      _get(_getPrototypeOf(CountDocumentsOperation.prototype), \"execute\", this).call(this, server, function (err, result) {\n        if (err) {\n          callback(err, null);\n          return;\n        } // NOTE: We're avoiding creating a cursor here to reduce the callstack.\n\n\n        var response = result.result;\n\n        if (response.cursor == null || response.cursor.firstBatch == null) {\n          callback(null, 0);\n          return;\n        }\n\n        var docs = response.cursor.firstBatch;\n        callback(null, docs.length ? docs[0].n : 0);\n      });\n    }\n  }]);\n\n  return CountDocumentsOperation;\n}(AggregateOperation);\n\nmodule.exports = CountDocumentsOperation;","map":{"version":3,"sources":["/Users/S/Desktop/nodeprotake2/node_modules/mongodb/lib/operations/count_documents.js"],"names":["AggregateOperation","require","CountDocumentsOperation","collection","query","options","pipeline","$match","skip","push","$skip","limit","$limit","$group","_id","n","$sum","server","callback","err","result","response","cursor","firstBatch","docs","length","module","exports"],"mappings":"AAAA;;;;;;;;;;;;;;AAEA,IAAMA,kBAAkB,GAAGC,OAAO,CAAC,aAAD,CAAlC;;IAEMC,uB;;;;;AACJ,mCAAYC,UAAZ,EAAwBC,KAAxB,EAA+BC,OAA/B,EAAwC;AAAA;;AACtC,QAAMC,QAAQ,GAAG,CAAC;AAAEC,MAAAA,MAAM,EAAEH;AAAV,KAAD,CAAjB;;AACA,QAAI,OAAOC,OAAO,CAACG,IAAf,KAAwB,QAA5B,EAAsC;AACpCF,MAAAA,QAAQ,CAACG,IAAT,CAAc;AAAEC,QAAAA,KAAK,EAAEL,OAAO,CAACG;AAAjB,OAAd;AACD;;AAED,QAAI,OAAOH,OAAO,CAACM,KAAf,KAAyB,QAA7B,EAAuC;AACrCL,MAAAA,QAAQ,CAACG,IAAT,CAAc;AAAEG,QAAAA,MAAM,EAAEP,OAAO,CAACM;AAAlB,OAAd;AACD;;AAEDL,IAAAA,QAAQ,CAACG,IAAT,CAAc;AAAEI,MAAAA,MAAM,EAAE;AAAEC,QAAAA,GAAG,EAAE,CAAP;AAAUC,QAAAA,CAAC,EAAE;AAAEC,UAAAA,IAAI,EAAE;AAAR;AAAb;AAAV,KAAd;AAVsC,6BAYhCb,UAZgC,EAYpBG,QAZoB,EAYVD,OAZU;AAavC;;;;4BAEOY,M,EAAQC,Q,EAAU;AACxB,2FAAcD,MAAd,EAAsB,UAACE,GAAD,EAAMC,MAAN,EAAiB;AACrC,YAAID,GAAJ,EAAS;AACPD,UAAAA,QAAQ,CAACC,GAAD,EAAM,IAAN,CAAR;AACA;AACD,SAJoC,CAMrC;;;AACA,YAAME,QAAQ,GAAGD,MAAM,CAACA,MAAxB;;AACA,YAAIC,QAAQ,CAACC,MAAT,IAAmB,IAAnB,IAA2BD,QAAQ,CAACC,MAAT,CAAgBC,UAAhB,IAA8B,IAA7D,EAAmE;AACjEL,UAAAA,QAAQ,CAAC,IAAD,EAAO,CAAP,CAAR;AACA;AACD;;AAED,YAAMM,IAAI,GAAGH,QAAQ,CAACC,MAAT,CAAgBC,UAA7B;AACAL,QAAAA,QAAQ,CAAC,IAAD,EAAOM,IAAI,CAACC,MAAL,GAAcD,IAAI,CAAC,CAAD,CAAJ,CAAQT,CAAtB,GAA0B,CAAjC,CAAR;AACD,OAfD;AAgBD;;;;EAjCmCf,kB;;AAoCtC0B,MAAM,CAACC,OAAP,GAAiBzB,uBAAjB","sourcesContent":["'use strict';\n\nconst AggregateOperation = require('./aggregate');\n\nclass CountDocumentsOperation extends AggregateOperation {\n  constructor(collection, query, options) {\n    const pipeline = [{ $match: query }];\n    if (typeof options.skip === 'number') {\n      pipeline.push({ $skip: options.skip });\n    }\n\n    if (typeof options.limit === 'number') {\n      pipeline.push({ $limit: options.limit });\n    }\n\n    pipeline.push({ $group: { _id: 1, n: { $sum: 1 } } });\n\n    super(collection, pipeline, options);\n  }\n\n  execute(server, callback) {\n    super.execute(server, (err, result) => {\n      if (err) {\n        callback(err, null);\n        return;\n      }\n\n      // NOTE: We're avoiding creating a cursor here to reduce the callstack.\n      const response = result.result;\n      if (response.cursor == null || response.cursor.firstBatch == null) {\n        callback(null, 0);\n        return;\n      }\n\n      const docs = response.cursor.firstBatch;\n      callback(null, docs.length ? docs[0].n : 0);\n    });\n  }\n}\n\nmodule.exports = CountDocumentsOperation;\n"]},"metadata":{},"sourceType":"script"}